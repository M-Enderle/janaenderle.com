---
import BaseLayout from './BaseLayout.astro';
import Navbar from '../components/common/Navbar.astro';
import Footer from '../components/common/Footer.astro';
import { getLangFromUrl } from '../utils/i18n';

export interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;
const lang = getLangFromUrl(Astro.url);
const currentPath = Astro.url.pathname;
---

<BaseLayout title={title} description={description} lang={lang}>
  <Navbar lang={lang} currentPath={currentPath} />
  <main>
    <slot />
  </main>
  <Footer lang={lang} />
  
  <!-- Scroll to top arrow -->
  <img 
    src="/arrow_up.svg" 
    width="50" 
    class="arrow-up" 
    id="scroll-to-top"
    alt="Scroll up icon"
  />
</BaseLayout>

<script>
  import { isMobile } from '../stores/app';

  // Scroll to top functionality
  function scrollToTop() {
    window.scrollTo({
      top: 0,
      behavior: 'smooth'
    });
  }

  // Handle scroll for arrow visibility
  function handleScroll() {
    const arrow = document.getElementById('scroll-to-top');
    if (arrow) {
      arrow.classList.toggle('hide', window.scrollY <= 100);
    }
  }

  // Initialize when DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    const arrow = document.getElementById('scroll-to-top');
    if (arrow) {
      arrow.addEventListener('click', scrollToTop);
    }
    
    window.addEventListener('scroll', handleScroll);
    window.addEventListener('resize', () => {
      isMobile.set(window.innerWidth < 768);
    });
    
    // Initial setup
    handleScroll();
    isMobile.set(window.innerWidth < 768);
  });
</script>